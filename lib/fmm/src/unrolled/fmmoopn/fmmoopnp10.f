#include "../../fmm.h"
c
#if FMM_MAXNMULTIPOLES > 9 && defined(FMM_UNROLLED)
      subroutine fmmoop10(xyzfrom,xyzto,f,g,h,roop,ioop)
c
      use fmmkinds
c
      implicit none
c
      real(kind=fmm_real) xyzfrom(*),xyzto(*),f(0:*),g(0:*),h(0:*),
     .roop(*),ioop(*),
     .one,zero,x,y,z,rsq,s
c
      one = f(0)
      zero = g(0)
      x = xyzfrom(1)-xyzto(1)
      y = xyzfrom(2)-xyzto(2)
      z = xyzfrom(3)-xyzto(3)
      rsq = x*x+y*y+z*z
      roop(   1) = one
      ioop(   1) = zero
      roop(   2) = z*roop(1)
      ioop(   2) = zero
      roop(   3) = f(1)*(x*roop(1))
      ioop(   3) = -f(1)*(y*roop(1))
      roop(   4) = g(   1)*((h(   0)*z)*roop(   2)-rsq*roop(   1))
      ioop(   4) = zero
      roop(   5) = z*roop(   3)
      ioop(   5) = z*ioop(   3)
      roop(   6) = f(   2)*(x*roop(   3)+y*ioop(   3))
      ioop(   6) = f(   2)*(x*ioop(   3)-y*roop(   3))
      s = h(   1)*z
      roop(   7) = g(   2)*(s*roop(   4)-rsq*roop(   2))
      ioop(   7) = zero
      roop(   8) = g(   3)*(s*roop(   5)-rsq*roop(   3))
      ioop(   8) = g(   3)*(s*ioop(   5)-rsq*ioop(   3))
      roop(   9) = z*roop(   6)
      ioop(   9) = z*ioop(   6)
      roop(  10) = f(   3)*(x*roop(   6)+y*ioop(   6))
      ioop(  10) = f(   3)*(x*ioop(   6)-y*roop(   6))
      s = h(   2)*z
      roop(  11) = g(   4)*(s*roop(   7)-rsq*roop(   4))
      ioop(  11) = zero
      roop(  12) = g(   5)*(s*roop(   8)-rsq*roop(   5))
      ioop(  12) = g(   5)*(s*ioop(   8)-rsq*ioop(   5))
      roop(  13) = g(   6)*(s*roop(   9)-rsq*roop(   6))
      ioop(  13) = g(   6)*(s*ioop(   9)-rsq*ioop(   6))
      roop(  14) = z*roop(  10)
      ioop(  14) = z*ioop(  10)
      roop(  15) = f(   4)*(x*roop(  10)+y*ioop(  10))
      ioop(  15) = f(   4)*(x*ioop(  10)-y*roop(  10))
      s = h(   3)*z
      roop(  16) = g(   7)*(s*roop(  11)-rsq*roop(   7))
      ioop(  16) = zero
      roop(  17) = g(   8)*(s*roop(  12)-rsq*roop(   8))
      ioop(  17) = g(   8)*(s*ioop(  12)-rsq*ioop(   8))
      roop(  18) = g(   9)*(s*roop(  13)-rsq*roop(   9))
      ioop(  18) = g(   9)*(s*ioop(  13)-rsq*ioop(   9))
      roop(  19) = g(  10)*(s*roop(  14)-rsq*roop(  10))
      ioop(  19) = g(  10)*(s*ioop(  14)-rsq*ioop(  10))
      roop(  20) = z*roop(  15)
      ioop(  20) = z*ioop(  15)
      roop(  21) = f(   5)*(x*roop(  15)+y*ioop(  15))
      ioop(  21) = f(   5)*(x*ioop(  15)-y*roop(  15))
      s = h(   4)*z
      roop(  22) = g(  11)*(s*roop(  16)-rsq*roop(  11))
      ioop(  22) = zero
      roop(  23) = g(  12)*(s*roop(  17)-rsq*roop(  12))
      ioop(  23) = g(  12)*(s*ioop(  17)-rsq*ioop(  12))
      roop(  24) = g(  13)*(s*roop(  18)-rsq*roop(  13))
      ioop(  24) = g(  13)*(s*ioop(  18)-rsq*ioop(  13))
      roop(  25) = g(  14)*(s*roop(  19)-rsq*roop(  14))
      ioop(  25) = g(  14)*(s*ioop(  19)-rsq*ioop(  14))
      roop(  26) = g(  15)*(s*roop(  20)-rsq*roop(  15))
      ioop(  26) = g(  15)*(s*ioop(  20)-rsq*ioop(  15))
      roop(  27) = z*roop(  21)
      ioop(  27) = z*ioop(  21)
      roop(  28) = f(   6)*(x*roop(  21)+y*ioop(  21))
      ioop(  28) = f(   6)*(x*ioop(  21)-y*roop(  21))
      s = h(   5)*z
      roop(  29) = g(  16)*(s*roop(  22)-rsq*roop(  16))
      ioop(  29) = zero
      roop(  30) = g(  17)*(s*roop(  23)-rsq*roop(  17))
      ioop(  30) = g(  17)*(s*ioop(  23)-rsq*ioop(  17))
      roop(  31) = g(  18)*(s*roop(  24)-rsq*roop(  18))
      ioop(  31) = g(  18)*(s*ioop(  24)-rsq*ioop(  18))
      roop(  32) = g(  19)*(s*roop(  25)-rsq*roop(  19))
      ioop(  32) = g(  19)*(s*ioop(  25)-rsq*ioop(  19))
      roop(  33) = g(  20)*(s*roop(  26)-rsq*roop(  20))
      ioop(  33) = g(  20)*(s*ioop(  26)-rsq*ioop(  20))
      roop(  34) = g(  21)*(s*roop(  27)-rsq*roop(  21))
      ioop(  34) = g(  21)*(s*ioop(  27)-rsq*ioop(  21))
      roop(  35) = z*roop(  28)
      ioop(  35) = z*ioop(  28)
      roop(  36) = f(   7)*(x*roop(  28)+y*ioop(  28))
      ioop(  36) = f(   7)*(x*ioop(  28)-y*roop(  28))
      s = h(   6)*z
      roop(  37) = g(  22)*(s*roop(  29)-rsq*roop(  22))
      ioop(  37) = zero
      roop(  38) = g(  23)*(s*roop(  30)-rsq*roop(  23))
      ioop(  38) = g(  23)*(s*ioop(  30)-rsq*ioop(  23))
      roop(  39) = g(  24)*(s*roop(  31)-rsq*roop(  24))
      ioop(  39) = g(  24)*(s*ioop(  31)-rsq*ioop(  24))
      roop(  40) = g(  25)*(s*roop(  32)-rsq*roop(  25))
      ioop(  40) = g(  25)*(s*ioop(  32)-rsq*ioop(  25))
      roop(  41) = g(  26)*(s*roop(  33)-rsq*roop(  26))
      ioop(  41) = g(  26)*(s*ioop(  33)-rsq*ioop(  26))
      roop(  42) = g(  27)*(s*roop(  34)-rsq*roop(  27))
      ioop(  42) = g(  27)*(s*ioop(  34)-rsq*ioop(  27))
      roop(  43) = g(  28)*(s*roop(  35)-rsq*roop(  28))
      ioop(  43) = g(  28)*(s*ioop(  35)-rsq*ioop(  28))
      roop(  44) = z*roop(  36)
      ioop(  44) = z*ioop(  36)
      roop(  45) = f(   8)*(x*roop(  36)+y*ioop(  36))
      ioop(  45) = f(   8)*(x*ioop(  36)-y*roop(  36))
      s = h(   7)*z
      roop(  46) = g(  29)*(s*roop(  37)-rsq*roop(  29))
      ioop(  46) = zero
      roop(  47) = g(  30)*(s*roop(  38)-rsq*roop(  30))
      ioop(  47) = g(  30)*(s*ioop(  38)-rsq*ioop(  30))
      roop(  48) = g(  31)*(s*roop(  39)-rsq*roop(  31))
      ioop(  48) = g(  31)*(s*ioop(  39)-rsq*ioop(  31))
      roop(  49) = g(  32)*(s*roop(  40)-rsq*roop(  32))
      ioop(  49) = g(  32)*(s*ioop(  40)-rsq*ioop(  32))
      roop(  50) = g(  33)*(s*roop(  41)-rsq*roop(  33))
      ioop(  50) = g(  33)*(s*ioop(  41)-rsq*ioop(  33))
      roop(  51) = g(  34)*(s*roop(  42)-rsq*roop(  34))
      ioop(  51) = g(  34)*(s*ioop(  42)-rsq*ioop(  34))
      roop(  52) = g(  35)*(s*roop(  43)-rsq*roop(  35))
      ioop(  52) = g(  35)*(s*ioop(  43)-rsq*ioop(  35))
      roop(  53) = g(  36)*(s*roop(  44)-rsq*roop(  36))
      ioop(  53) = g(  36)*(s*ioop(  44)-rsq*ioop(  36))
      roop(  54) = z*roop(  45)
      ioop(  54) = z*ioop(  45)
      roop(  55) = f(   9)*(x*roop(  45)+y*ioop(  45))
      ioop(  55) = f(   9)*(x*ioop(  45)-y*roop(  45))
      s = h(   8)*z
      roop(  56) = g(  37)*(s*roop(  46)-rsq*roop(  37))
      ioop(  56) = zero
      roop(  57) = g(  38)*(s*roop(  47)-rsq*roop(  38))
      ioop(  57) = g(  38)*(s*ioop(  47)-rsq*ioop(  38))
      roop(  58) = g(  39)*(s*roop(  48)-rsq*roop(  39))
      ioop(  58) = g(  39)*(s*ioop(  48)-rsq*ioop(  39))
      roop(  59) = g(  40)*(s*roop(  49)-rsq*roop(  40))
      ioop(  59) = g(  40)*(s*ioop(  49)-rsq*ioop(  40))
      roop(  60) = g(  41)*(s*roop(  50)-rsq*roop(  41))
      ioop(  60) = g(  41)*(s*ioop(  50)-rsq*ioop(  41))
      roop(  61) = g(  42)*(s*roop(  51)-rsq*roop(  42))
      ioop(  61) = g(  42)*(s*ioop(  51)-rsq*ioop(  42))
      roop(  62) = g(  43)*(s*roop(  52)-rsq*roop(  43))
      ioop(  62) = g(  43)*(s*ioop(  52)-rsq*ioop(  43))
      roop(  63) = g(  44)*(s*roop(  53)-rsq*roop(  44))
      ioop(  63) = g(  44)*(s*ioop(  53)-rsq*ioop(  44))
      roop(  64) = g(  45)*(s*roop(  54)-rsq*roop(  45))
      ioop(  64) = g(  45)*(s*ioop(  54)-rsq*ioop(  45))
      roop(  65) = z*roop(  55)
      ioop(  65) = z*ioop(  55)
      roop(  66) = f(  10)*(x*roop(  55)+y*ioop(  55))
      ioop(  66) = f(  10)*(x*ioop(  55)-y*roop(  55))
      return
      end subroutine fmmoop10
#endif
